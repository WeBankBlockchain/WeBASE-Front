Asset,cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjE7DQoNCmNvbnRyYWN0IEFzc2V0IHsNCiAgICBhZGRyZXNzIHB1YmxpYyBpc3N1ZXI7DQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgYmFsYW5jZXM7DQoNCiAgICBldmVudCBTZW50KGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCBhbW91bnQpOw0KDQogICAgY29uc3RydWN0b3IoKSB7DQogICAgICAgIGlzc3VlciA9IG1zZy5zZW5kZXI7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gaXNzdWUoYWRkcmVzcyByZWNlaXZlciwgdWludCBhbW91bnQpIHB1YmxpYyB7DQogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IGlzc3VlcikgcmV0dXJuOw0KICAgICAgICBiYWxhbmNlc1tyZWNlaXZlcl0gKz0gYW1vdW50Ow0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNlbmQoYWRkcmVzcyByZWNlaXZlciwgdWludCBhbW91bnQpIHB1YmxpYyB7DQogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA8IGFtb3VudCkgcmV0dXJuOw0KICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBhbW91bnQ7DQogICAgICAgIGJhbGFuY2VzW3JlY2VpdmVyXSArPSBhbW91bnQ7DQogICAgICAgIGVtaXQgU2VudChtc2cuc2VuZGVyLCByZWNlaXZlciwgYW1vdW50KTsNCiAgICB9DQogICAgDQp9DQo=
Evidence,cHJhZ21hIHNvbGlkaXR5IF4wLjQuNDsNCg0KY29udHJhY3QgRXZpZGVuY2VTaWduZXJzRGF0YUFCSQ0Kew0KCWZ1bmN0aW9uIHZlcmlmeShhZGRyZXNzIGFkZHIpcHVibGljIGNvbnN0YW50IHJldHVybnMoYm9vbCl7fQ0KCWZ1bmN0aW9uIGdldFNpZ25lcih1aW50IGluZGV4KXB1YmxpYyBjb25zdGFudCByZXR1cm5zKGFkZHJlc3Mpe30gDQoJZnVuY3Rpb24gZ2V0U2lnbmVyc1NpemUoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50KXt9DQp9DQoNCmNvbnRyYWN0IEV2aWRlbmNlew0KICAgIA0KICAgIHN0cmluZyBldmlkZW5jZTsNCiAgICBhZGRyZXNzW10gc2lnbmVyczsNCiAgICBhZGRyZXNzIHB1YmxpYyBmYWN0b3J5QWRkcjsNCiAgICANCiAgICBldmVudCBhZGRTaWduYXR1cmVzRXZlbnQoc3RyaW5nIGV2aSk7DQogICAgZXZlbnQgbmV3U2lnbmF0dXJlc0V2ZW50KHN0cmluZyBldmksIGFkZHJlc3MgYWRkcik7DQogICAgZXZlbnQgZXJyb3JOZXdTaWduYXR1cmVzRXZlbnQoc3RyaW5nIGV2aSwgYWRkcmVzcyBhZGRyKTsNCiAgICBldmVudCBlcnJvckFkZFNpZ25hdHVyZXNFdmVudChzdHJpbmcgZXZpLCBhZGRyZXNzIGFkZHIpOw0KICAgIGV2ZW50IGFkZFJlcGVhdFNpZ25hdHVyZXNFdmVudChzdHJpbmcgZXZpKTsNCiAgICBldmVudCBlcnJvclJlcGVhdFNpZ25hdHVyZXNFdmVudChzdHJpbmcgZXZpLCBhZGRyZXNzIGFkZHIpOw0KDQogICAgZnVuY3Rpb24gQ2FsbFZlcmlmeShhZGRyZXNzIGFkZHIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKGJvb2wpIHsNCiAgICAgICAgcmV0dXJuIEV2aWRlbmNlU2lnbmVyc0RhdGFBQkkoZmFjdG9yeUFkZHIpLnZlcmlmeShhZGRyKTsNCiAgICB9DQoNCiAgIGNvbnN0cnVjdG9yKHN0cmluZyBldmksIGFkZHJlc3MgYWRkcikgIHsNCiAgICAgICBmYWN0b3J5QWRkciA9IGFkZHI7DQogICAgICAgaWYoQ2FsbFZlcmlmeSh0eC5vcmlnaW4pKQ0KICAgICAgIHsNCiAgICAgICAgICAgZXZpZGVuY2UgPSBldmk7DQogICAgICAgICAgIHNpZ25lcnMucHVzaCh0eC5vcmlnaW4pOw0KICAgICAgICAgICBuZXdTaWduYXR1cmVzRXZlbnQoZXZpLGFkZHIpOw0KICAgICAgIH0NCiAgICAgICBlbHNlDQogICAgICAgew0KICAgICAgICAgICBlcnJvck5ld1NpZ25hdHVyZXNFdmVudChldmksYWRkcik7DQogICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGdldEV2aWRlbmNlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMoc3RyaW5nLGFkZHJlc3NbXSxhZGRyZXNzW10pew0KICAgICAgICB1aW50IGxlbmd0aCA9IEV2aWRlbmNlU2lnbmVyc0RhdGFBQkkoZmFjdG9yeUFkZHIpLmdldFNpZ25lcnNTaXplKCk7DQogICAgICAgICBhZGRyZXNzW10gbWVtb3J5IHNpZ25lckxpc3QgPSBuZXcgYWRkcmVzc1tdKGxlbmd0aCk7DQogICAgICAgICBmb3IodWludCBpPSAwIDtpPGxlbmd0aCA7aSsrKQ0KICAgICAgICAgew0KICAgICAgICAgICAgIHNpZ25lckxpc3RbaV0gPSAoRXZpZGVuY2VTaWduZXJzRGF0YUFCSShmYWN0b3J5QWRkcikuZ2V0U2lnbmVyKGkpKTsNCiAgICAgICAgIH0NCiAgICAgICAgcmV0dXJuKGV2aWRlbmNlLHNpZ25lckxpc3Qsc2lnbmVycyk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYWRkU2lnbmF0dXJlcygpIHB1YmxpYyByZXR1cm5zKGJvb2wpIHsNCiAgICAgICAgZm9yKHVpbnQgaT0gMCA7aTxzaWduZXJzLmxlbmd0aCA7aSsrKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZih0eC5vcmlnaW4gPT0gc2lnbmVyc1tpXSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBhZGRSZXBlYXRTaWduYXR1cmVzRXZlbnQoZXZpZGVuY2UpOw0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgaWYoQ2FsbFZlcmlmeSh0eC5vcmlnaW4pKQ0KICAgICAgIHsNCiAgICAgICAgICAgIHNpZ25lcnMucHVzaCh0eC5vcmlnaW4pOw0KICAgICAgICAgICAgYWRkU2lnbmF0dXJlc0V2ZW50KGV2aWRlbmNlKTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgIH0NCiAgICAgICBlbHNlDQogICAgICAgew0KICAgICAgICAgICBlcnJvckFkZFNpZ25hdHVyZXNFdmVudChldmlkZW5jZSx0eC5vcmlnaW4pOw0KICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgfQ0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBnZXRTaWduZXJzKClwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhhZGRyZXNzW10pDQogICAgew0KICAgICAgICAgdWludCBsZW5ndGggPSBFdmlkZW5jZVNpZ25lcnNEYXRhQUJJKGZhY3RvcnlBZGRyKS5nZXRTaWduZXJzU2l6ZSgpOw0KICAgICAgICAgYWRkcmVzc1tdIG1lbW9yeSBzaWduZXJMaXN0ID0gbmV3IGFkZHJlc3NbXShsZW5ndGgpOw0KICAgICAgICAgZm9yKHVpbnQgaT0gMCA7aTxsZW5ndGggO2krKykNCiAgICAgICAgIHsNCiAgICAgICAgICAgICBzaWduZXJMaXN0W2ldID0gKEV2aWRlbmNlU2lnbmVyc0RhdGFBQkkoZmFjdG9yeUFkZHIpLmdldFNpZ25lcihpKSk7DQogICAgICAgICB9DQogICAgICAgICByZXR1cm4gc2lnbmVyTGlzdDsNCiAgICB9DQp9
EvidenceFactory,cHJhZ21hIHNvbGlkaXR5IF4wLjQuNDsNCmltcG9ydCAiRXZpZGVuY2Uuc29sIjsNCg0KY29udHJhY3QgRXZpZGVuY2VGYWN0b3J5ew0KICAgICAgICBhZGRyZXNzW10gc2lnbmVyczsNCgkJZXZlbnQgbmV3RXZpZGVuY2VFdmVudChhZGRyZXNzIGFkZHIpOw0KICAgICAgICBmdW5jdGlvbiBuZXdFdmlkZW5jZShzdHJpbmcgZXZpKXB1YmxpYyByZXR1cm5zKGFkZHJlc3MpDQogICAgICAgIHsNCiAgICAgICAgICAgIEV2aWRlbmNlIGV2aWRlbmNlID0gbmV3IEV2aWRlbmNlKGV2aSwgdGhpcyk7DQogICAgICAgICAgICBuZXdFdmlkZW5jZUV2ZW50KGV2aWRlbmNlKTsNCiAgICAgICAgICAgIHJldHVybiBldmlkZW5jZTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgZnVuY3Rpb24gZ2V0RXZpZGVuY2UoYWRkcmVzcyBhZGRyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhzdHJpbmcsYWRkcmVzc1tdLGFkZHJlc3NbXSl7DQogICAgICAgICAgICByZXR1cm4gRXZpZGVuY2UoYWRkcikuZ2V0RXZpZGVuY2UoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgDQogICAgICAgIGZ1bmN0aW9uIGFkZFNpZ25hdHVyZXMoYWRkcmVzcyBhZGRyKSBwdWJsaWMgcmV0dXJucyhib29sKSB7DQogICAgICAgICAgICByZXR1cm4gRXZpZGVuY2UoYWRkcikuYWRkU2lnbmF0dXJlcygpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25zdHJ1Y3RvcihhZGRyZXNzW10gZXZpZGVuY2VTaWduZXJzKXsNCiAgICAgICAgICAgIGZvcih1aW50IGk9MDsgaTxldmlkZW5jZVNpZ25lcnMubGVuZ3RoOyArK2kpIHsNCiAgICAgICAgICAgIHNpZ25lcnMucHVzaChldmlkZW5jZVNpZ25lcnNbaV0pOw0KCQkJfQ0KCQl9DQoNCiAgICAgICAgZnVuY3Rpb24gdmVyaWZ5KGFkZHJlc3MgYWRkcilwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhib29sKXsNCiAgICAgICAgICAgICAgICBmb3IodWludCBpPTA7IGk8c2lnbmVycy5sZW5ndGg7ICsraSkgew0KICAgICAgICAgICAgICAgIGlmIChhZGRyID09IHNpZ25lcnNbaV0pDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBmdW5jdGlvbiBnZXRTaWduZXIodWludCBpbmRleClwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhhZGRyZXNzKXsNCiAgICAgICAgICAgIHVpbnQgbGlzdFNpemUgPSBzaWduZXJzLmxlbmd0aDsNCiAgICAgICAgICAgIGlmKGluZGV4IDwgbGlzdFNpemUpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25lcnNbaW5kZXhdOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgfQ0KICAgIA0KICAgICAgICB9DQoNCiAgICAgICAgZnVuY3Rpb24gZ2V0U2lnbmVyc1NpemUoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50KXsNCiAgICAgICAgICAgIHJldHVybiBzaWduZXJzLmxlbmd0aDsNCiAgICAgICAgfQ0KICAgIA0KICAgICAgICBmdW5jdGlvbiBnZXRTaWduZXJzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMoYWRkcmVzc1tdKXsNCiAgICAgICAgICAgIHJldHVybiBzaWduZXJzOw0KICAgICAgICB9DQoNCn0=